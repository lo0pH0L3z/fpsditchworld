<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PS5 FPS Range</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="scope-overlay">
        <div id="scope-crosshair"></div>
        <div id="scope-crosshair-v"></div>
    </div>

    <div id="ui-layer">
        <div class="hud-bar">
            <div class="hud-text" id="ammo">AMMO: -- / --</div>
            <div class="hud-text" id="mp-status" style="color: #888;">CONNECTING...</div>
        </div>

        <div id="kill-feed"></div>

        <!-- Health & Armor HUD -->
        <div id="health-armor-container">
            <div id="armor-plates">
                <div id="plate-1" class="armor-plate"></div>
                <div id="plate-2" class="armor-plate"></div>
                <div id="plate-3" class="armor-plate"></div>
            </div>
            <div id="health-bar-container">
                <div id="health-fill"></div>
            </div>
        </div>

        <div id="center-reticle">
            <div id="center-dot"></div>
        </div>
        <div id="hit-marker">
            <div class="hit-marker-circle"></div>
            <div class="hit-marker-line rotate-pos"></div>
            <div class="hit-marker-line rotate-neg"></div>
        </div>


        <div class="hit-marker-line rotate-neg"></div>
    </div>

    <div id="debug-panel"></div>

    <!-- Vehicle Interaction Prompt -->
    <div id="vehicle-prompt" style="display: none;">
        Hold <span class="button-icon">‚ñ°</span> to Enter Vehicle
    </div>

    <!-- Death Screen -->
    <div id="death-screen" style="display: none;">
        <h1>YOU DIED</h1>
        <p>Killed by <span id="killer-name">Unknown</span></p>
        <button id="respawn-btn">RESPAWN (X)</button>
    </div>

    <!-- Vehicle HUD (Speedometer & Gear) -->
    <div id="vehicle-hud" style="display: none;">
        <div id="speedometer">
            <span id="speed-value">0</span>
            <span id="speed-unit">KM/H</span>
        </div>
        <div id="gear-indicator">
            <span id="gear-label">GEAR</span>
            <span id="gear-value">1</span>
        </div>
    </div>

    <!-- Cinema Interaction Prompt -->
    <div id="cinema-prompt" style="display: none;">
        Press <span class="button-icon">‚ñ≥</span> to Control Cinema
    </div>

    <!-- Cinema Control Modal -->
    <div id="cinema-modal" style="display: none;">
        <div class="cinema-content">
            <h2>üé¨ PUBLIC CINEMA</h2>
            <p class="cinema-hint">Paste a YouTube, Twitch, or video URL</p>
            <input type="text" id="cinema-url" placeholder="https://youtube.com/watch?v=...">
            <div class="cinema-actions">
                <button id="cinema-play">‚ñ∂ PLAY</button>
                <button id="cinema-fullscreen">‚õ∂ FULLSCREEN</button>
                <button id="cinema-close">‚úï CLOSE</button>
            </div>
            <!-- Playback Controls -->
            <div class="cinema-playback" id="cinema-playback-controls" style="display: none;">
                <div class="playback-row">
                    <button id="cinema-pause-toggle">‚è∏ PAUSE</button>
                    <button id="cinema-stop">‚èπ STOP</button>
                </div>
                <div class="playback-row">
                    <label>üîä Volume:</label>
                    <input type="range" id="cinema-volume" min="0" max="100" value="50">
                    <span id="cinema-volume-val">50%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Cinema Video Overlay -->
    <div id="cinema-overlay" style="display: none;">
        <iframe id="cinema-iframe"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen>
        </iframe>
        <button id="cinema-minimize">‚úï</button>
    </div>

    <!-- Hidden checkbox for invert Y-axis state (syncs with modal) -->
    <input type="checkbox" id="invert-look">

    <div class="settings-btn-wrapper">
        <button id="settings-btn" tabindex="-1">SETTINGS</button>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal">
        <div class="settings-content">
            <h2>SETTINGS</h2>

            <div class="settings-section">
                <h3>Movement</h3>
                <label>
                    Walk Speed: <span id="walk-speed-val">10</span>
                    <input type="range" id="walk-speed" min="5" max="20" value="10" step="1">
                </label>
                <label>
                    Sprint Speed: <span id="sprint-speed-val">15</span>
                    <input type="range" id="sprint-speed" min="10" max="30" value="15" step="1">
                </label>
                <label>
                    Crouch Speed: <span id="crouch-speed-val">5</span>
                    <input type="range" id="crouch-speed" min="2" max="10" value="5" step="0.5">
                </label>
                <label>
                    Slide Speed: <span id="slide-speed-val">20</span>
                    <input type="range" id="slide-speed" min="10" max="40" value="20" step="1">
                </label>
                <label>
                    Jump Force: <span id="jump-force-val">8</span>
                    <input type="range" id="jump-force" min="4" max="15" value="8" step="0.5">
                </label>
                <label>
                    Air Control: <span id="air-control-val">0.5</span>
                    <input type="range" id="air-control" min="0" max="1" value="0.5" step="0.1">
                </label>
                <label>
                    Gravity: <span id="gravity-val">20</span>
                    <input type="range" id="gravity" min="5" max="100" value="20" step="1">
                </label>
                <label>
                    <input type="checkbox" id="head-bob-enabled" checked> Enable Head Bob
                </label>
                <label>
                    Head Bob Amount: <span id="head-bob-amount-val">1.0</span>
                    <input type="range" id="head-bob-amount" min="0" max="2" value="1.0" step="0.1">
                </label>
            </div>

            <div class="settings-section">
                <h3>Aim</h3>
                <label>
                    Horizontal Sensitivity: <span id="look-speed-h-val">2.0</span>
                    <input type="range" id="look-speed-h" min="0.5" max="5" value="2" step="0.1">
                </label>
                <label>
                    Vertical Sensitivity: <span id="look-speed-v-val">2.0</span>
                    <input type="range" id="look-speed-v" min="0.5" max="5" value="2" step="0.1">
                </label>
                <label>
                    ADS Sensitivity: <span id="ads-speed-val">0.5</span>
                    <input type="range" id="ads-speed" min="0.1" max="2" value="0.5" step="0.1">
                </label>
                <label>
                    ADS Horizontal Multiplier: <span id="ads-multiplier-h-val">1.0</span>
                    <input type="range" id="ads-multiplier-h" min="0.1" max="2" value="1.0" step="0.05">
                </label>
                <label>
                    ADS Vertical Multiplier: <span id="ads-multiplier-v-val">1.0</span>
                    <input type="range" id="ads-multiplier-v" min="0.1" max="2" value="1.0" step="0.05">
                </label>
                <label>
                    Mouse Sensitivity Multiplier: <span id="mouse-sens-mult-val">1.0</span>
                    <input type="range" id="mouse-sens-mult" min="0.1" max="3" value="1.0" step="0.1">
                </label>
                <label>
                    ADS Transition Speed: <span id="ads-transition-speed-val">10.0</span>
                    <input type="range" id="ads-transition-speed" min="1" max="20" value="10" step="0.5">
                </label>
                <label>
                    <input type="checkbox" id="invert-look-modal"> Invert Y-Axis
                </label>
                <label>
                    <input type="checkbox" id="fov-scale-sticks" checked> FOV Scaling (Sticks)
                </label>
                <label>
                    FOV Scale Strength: <span id="fov-scale-sticks-strength-val">1.00</span>
                    <input type="range" id="fov-scale-sticks-strength" min="0" max="1" value="1" step="0.05">
                </label>
            </div>

            <div class="settings-section">
                <h3>Motion Sensor</h3>
                <label>
                    <input type="checkbox" id="motion-enabled"> Enable Motion Aiming
                </label>
                <label>
                    Motion Horizontal Sensitivity: <span id="motion-sens-h-val">1.0</span>
                    <input type="range" id="motion-sens-h" min="0.1" max="500" value="1" step="0.1">
                </label>
                <label>
                    Motion Vertical Sensitivity: <span id="motion-sens-v-val">1.0</span>
                    <input type="range" id="motion-sens-v" min="0.1" max="500" value="1" step="0.1">
                </label>
                <label>
                    <input type="checkbox" id="motion-invert-y"> Motion Invert Y-Axis
                </label>
                <label>
                    Motion ADS Horizontal Multiplier: <span id="motion-ads-multiplier-h-val">1.00</span>
                    <input type="range" id="motion-ads-multiplier-h" min="0.1" max="2" value="1.0" step="0.05">
                </label>
                <label>
                    Motion ADS Vertical Multiplier: <span id="motion-ads-multiplier-v-val">1.00</span>
                    <input type="range" id="motion-ads-multiplier-v" min="0.1" max="2" value="1.0" step="0.05">
                </label>
                <label>
                    <input type="checkbox" id="motion-fov-scale" checked> Motion FOV Scaling
                </label>
                <label>
                    Motion FOV Scale Strength: <span id="motion-fov-scale-strength-val">1.00</span>
                    <input type="range" id="motion-fov-scale-strength" min="0" max="1" value="1" step="0.05">
                </label>
                <label>
                    Deadzone (¬∞/s): <span id="motion-deadzone-val">0.000</span>
                    <input type="range" id="motion-deadzone" min="0" max="1" value="0" step="0.001">
                </label>
                <div class="motion-row" style="margin-bottom: 10px;">
                    <button id="motion-calibrate" type="button">CALIBRATE (LAY FLAT)</button>
                </div>
                <div class="motion-row">
                    <button id="motion-connect" type="button">CONNECT DUALSENSE</button>
                    <span id="motion-status">WebHID idle</span>
                </div>
                <div style="margin-top: 10px; font-size: 11px; opacity: 0.7;">
                    <strong>Debug Hotkeys:</strong> F6=Cycle Yaw Axis, F7=Flip Yaw, F8=Cycle Pitch Axis, F9=Flip
                    Pitch
                </div>
            </div>

            <div class="settings-section">
                <h3>Voice Chat</h3>
                <label>
                    <input type="checkbox" id="voice-mute-mic"> Mute Microphone
                </label>
                <label>
                    <input type="checkbox" id="voice-deafen"> Deafen (Mute Audio)
                </label>
                <label>
                    Volume: <span id="voice-volume-val">100%</span>
                    <input type="range" id="voice-volume" min="0" max="1" value="1" step="0.05">
                </label>
                <label>
                    Output Device:
                    <select id="voice-output-device">
                        <option value="">Default</option>
                    </select>
                </label>
                <label>
                    Input Device (Microphone):
                    <select id="voice-input-device">
                        <option value="">Default</option>
                    </select>
                </label>
            </div>

            <div class="settings-section">
                <h3>Display</h3>
                <label>
                    <input type="checkbox" id="cinema-overlap"> Cinema Overlap (screen always on top)
                </label>
                <p style="font-size: 10px; opacity: 0.6; margin-top: 5px;">When OFF, cinema hides behind walls</p>
            </div>

            <div class="settings-actions">
                <button id="close-settings">CLOSE</button>
            </div>
        </div>
    </div>
    </div>

    <!-- Error Logger & Loading Screen -->

    <div id="loading-overlay" style="text-align: center; line-height: 1.8;">

    </div>
    <div id="error-log">
        <h3>ERROR LOG:</h3>
    </div>

    <script>
        window.onerror = function (msg, url, line, col, error) {
            const log = document.getElementById('error-log');
            log.style.display = 'block';
            log.innerHTML += `<div>[${new Date().toLocaleTimeString()}] ${msg}<br><small>${url}:${line}:${col}</small></div><hr>`;
            document.getElementById('loading-overlay').style.display = 'none';
            return false;
        };

        window.addEventListener('unhandledrejection', function (event) {
            const log = document.getElementById('error-log');
            log.style.display = 'block';
            log.innerHTML += `<div>[${new Date().toLocaleTimeString()}] Unhandled Promise Rejection: ${event.reason}</div><hr>`;
        });
    </script>

    <!-- Import Map for Three.js -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>

    <script type="module" src="js/core/script.js"></script>
</body>

</html>